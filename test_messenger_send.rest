### Tests API Messenger Send

# Variables
@baseUrl = http://localhost:3000
@conversationId = 550e8400-e29b-41d4-a716-446655440000

### 1. GET - R√©cup√©rer l'historique des messages d'une conversation
GET {{baseUrl}}/api/messenger/send?conversationId={{conversationId}}&limit=20&offset=0
Content-Type: application/json

###

### 2. POST - Envoyer un message texte simple
POST {{baseUrl}}/api/messenger/send
Content-Type: application/json

{
  "conversationId": "{{conversationId}}",
  "message": "Bonjour ! Merci pour votre message. Comment puis-je vous aider ?",
  "messageType": "TEXT"
}

###

### 3. POST - Envoyer un message avec image
POST {{baseUrl}}/api/messenger/send
Content-Type: application/json

{
  "conversationId": "{{conversationId}}",
  "message": "Voici notre nouveau produit !",
  "messageType": "IMAGE",
  "mediaUrl": "https://example.com/product-image.jpg"
}

###

### 4. POST - Envoyer un fichier
POST {{baseUrl}}/api/messenger/send
Content-Type: application/json

{
  "conversationId": "{{conversationId}}",
  "message": "Voici notre catalogue PDF",
  "messageType": "FILE",
  "mediaUrl": "https://example.com/catalogue.pdf"
}

###

### 5. POST - Test avec donn√©es manquantes (doit √©chouer)
POST {{baseUrl}}/api/messenger/send
Content-Type: application/json

{
  "conversationId": "{{conversationId}}"
  // message manquant
}

###

### 6. POST - Test avec conversation inexistante (doit √©chouer)
POST {{baseUrl}}/api/messenger/send
Content-Type: application/json

{
  "conversationId": "00000000-0000-0000-0000-000000000000",
  "message": "Test avec conversation inexistante"
}

###

### 7. GET - Test avec conversationId manquant (doit √©chouer)
GET {{baseUrl}}/api/messenger/send
Content-Type: application/json

###

### 8. POST - Message de r√©ponse automatique
POST {{baseUrl}}/api/messenger/send
Content-Type: application/json

{
  "conversationId": "{{conversationId}}",
  "message": "Merci pour votre int√©r√™t ! Un de nos conseillers va vous r√©pondre dans les plus brefs d√©lais. En attendant, vous pouvez consulter notre catalogue sur notre site web.",
  "messageType": "TEXT"
}

###

### 9. POST - Message avec √©mojis
POST {{baseUrl}}/api/messenger/send
Content-Type: application/json

{
  "conversationId": "{{conversationId}}",
  "message": "Salut ! üëã Nous avons de super offres cette semaine ! üéâ Voulez-vous en savoir plus ? üòä",
  "messageType": "TEXT"
}

###

### 10. GET - R√©cup√©rer plus de messages (pagination)
GET {{baseUrl}}/api/messenger/send?conversationId={{conversationId}}&limit=10&offset=20
Content-Type: application/json

###

### Notes pour les tests :
# 1. Remplacez {{conversationId}} par un ID de conversation valide de votre base de donn√©es
# 2. Assurez-vous que la conversation a un customer avec un externalId valide
# 3. V√©rifiez que le canal (channel) associ√© a un accessToken valide
# 4. Pour les tests d'images/fichiers, utilisez des URLs accessibles publiquement
# 5. Les tests n√©cessitent une base de donn√©es configur√©e avec des donn√©es de test

### Donn√©es de test recommand√©es √† ins√©rer en base :
# - Un Shop avec un ownerId valide
# - Un Channel de type FACEBOOK_PAGE ou INSTAGRAM_DM avec accessToken
# - Un Customer avec externalId (ID utilisateur Meta)
# - Une Conversation li√©e au Customer et au Shop